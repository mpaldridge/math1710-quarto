<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>MATH1710 Probability and Statistics 1 - 8&nbsp; Two theorems on conditional probability</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../sections/L09-discrete-rv.html" rel="next">
<link href="../sections/L07-conditional.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Two theorems on conditional probability</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">MATH1710</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../about.html" class="sidebar-item-text sidebar-link">About MATH1710</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Exploratory data analysis</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L01-stats.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Summary statistics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L02-dataviz.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data visualisations</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Probability</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L03-events.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Sample spaces and events</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L04-probability.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L05-classical-i.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Classical probability I</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L06-classical-ii.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Classical probability II</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L07-conditional.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Independence and conditional probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L08-two-theorems.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Two theorems on conditional probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L09-discrete-rv.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Discrete random variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L10-expectation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Expectation and variance</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L11-binomial-geometric.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Binomial and geometric distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L12-poisson.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Poisson distribution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L13-multi-rv.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Multiple random variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L14-covariance.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Expectation and covariance</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L15-continuous.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Continuous random variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L17-normal.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Normal distribution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L16-exponential-multi.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Exponential distribution and multiple continuous random variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L18-limit.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Limit theorems</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Bayesian statistics</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L19-bayes-idea.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">The Bayesian idea</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L20-bayes-models.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">More Bayesian models</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Other stuff</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L21-summary.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">All questions answered</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L22-exam.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Exam</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../R/R.html" class="sidebar-item-text sidebar-link">R Worksheets</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../writing.html" class="sidebar-item-text sidebar-link">Tips on writing mathematics</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#total-prob" id="toc-total-prob" class="nav-link active" data-scroll-target="#total-prob"><span class="toc-section-number">8.1</span>  Law of total probability</a></li>
  <li><a href="#bayes" id="toc-bayes" class="nav-link" data-scroll-target="#bayes"><span class="toc-section-number">8.2</span>  Bayes’ theorem</a></li>
  <li><a href="#screening" id="toc-screening" class="nav-link" data-scroll-target="#screening"><span class="toc-section-number">8.3</span>  Diagnostic testing</a></li>
  <li><a href="#summary-L08" id="toc-summary-L08" class="nav-link" data-scroll-target="#summary-L08">Summary</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="L08-two-theorems" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Two theorems on conditional probability</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Last time we met the conditional probability <span class="math inline">\(\mathbb P(B \mid A)\)</span> of one event <span class="math inline">\(B\)</span> given another event <span class="math inline">\(A\)</span>. In this lecture we will be looking two very useful theorems about conditional probability, called the <strong>law of total probability</strong> and <strong>Bayes’ theorem</strong> – and they’re particularly powerful when used together.</p>
<section id="total-prob" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="total-prob"><span class="header-section-number">8.1</span> Law of total probability</h2>
<!--
:::: {.videowrap}
::: {.videowrapper}
<iframe src="https://www.youtube.com/embed/zBfFOYkfoss"></iframe>
:::
::::
-->
<div id="dice-total" class="example">
<p><em>My friend has three dice: a 4-sided dice, a 6-side dice, and a 10-side dice. He picks one of them at random, with each dice equally likely. What is the probability my friend rolls a 5?</em></p>
<p>If my friend were to tell which dice he picked, then this question would be very easy! If we write <span class="math inline">\(D_4\)</span>, <span class="math inline">\(D_6\)</span> and <span class="math inline">\(D_{10}\)</span> to be the events that he picks the 4-sided, 6-sided, or 10-sided dice, then we know immediately that [ P( D_4) = 0 P( D_6) = P( D_{10}) = . ] What we need is a way to combine the results for different “sub-cases” into an over-all answer.</p>
</div>
<p>Luckily, there exists just such a tool for this job! It’s called the “law of total probability” (also known as the “partition theorem”). The important point is to make sure that the different sub-cases cover all possibilities, but that only one of them happens at a time.</p>
<div class="definition">
<p>A set of events <span class="math inline">\(A_1, A_2, \dots, A_n\)</span> are said to be a <strong>partition</strong> of the sample space <span class="math inline">\(\Omega\)</span> if</p>
<ol type="1">
<li>they are disjoint, in that <span class="math inline">\(A_i \cap A_j = \varnothing\)</span> for all <span class="math inline">\(i \neq j\)</span>;</li>
<li>they cover space, in that <span class="math inline">\(A_1 \cup A_2 \cup \cdots \cup A_n = \Omega\)</span>.</li>
</ol>
</div>
<div id="thlawtotal" class="theorem" name="Law of total probability">
<p>Let <span class="math inline">\(A_1, A_2, \dots, A_n\)</span> be a partition, and <span class="math inline">\(B\)</span> another event. Then [ P(B) = _{i=1}^n P(A_i) , P(B A_i) . ]</p>
</div>
<p>So the law of total probability tells us we can add up the probabilities <span class="math inline">\(\mathbb P(B \mid A_i)\)</span> for each of the sub-cases provided we weight them by how likely <span class="math inline">\(\mathbb P(A_i)\)</span> by how likely each sub-case is.</p>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Since the partition of <span class="math inline">\(A_i\)</span>s cover space, we can split up <span class="math inline">\(B\)</span> depending on which part of the partition it is in: [ B = (B A_1) (B A_2) (B A_n) . ]</p>
<p><em>[I meant to draw a picture here, but didn’t get round to it – perhaps you’d like to draw your own?]</em></p>
<p>Since the <span class="math inline">\(A_i\)</span> are disjoint, the union on the right is disjoint also. Therefore we can use Axiom 3 to get [ P(B) = _{i=1}^n P(B A_i) . ] But using the definition of conditional probability, each “summand” (term inside the sum) is [ P(B A_i) = P(A_i) , P(B A_i) . ] The result follows.</p>
</div>
<div class="thpart">
<p><strong>Example @ref(exm:dice-total) continued.</strong> Returning to our dice example, we see that <span class="math inline">\(\{D_4, D_6, D_{10}\}\)</span> is indeed a partition, since my friend must choose exactly one of the three dice. So the law of total probability tells us that [ P() = P(D_4) , P( D_4) + P(D_6) , P( D_6) + P(D_{10}) , P( D_{10}) . ]</p>
<p>We were told that all the dice were picked with equal probability, so <span class="math inline">\(\mathbb P(D_4) = \mathbb P(D_6) = \mathbb P(D_{10}) = \frac13\)</span>, and we’ve already calculated the individual conditional probabilities as [ P( D_4) = 0 P( D_6) = P( D_{10}) = . ] Therefore, we have [ P() = + + = = 0.089. ]</p>
</div>
</section>
<section id="bayes" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="bayes"><span class="header-section-number">8.2</span> Bayes’ theorem</h2>
<!--
:::: {.videowrap}
::: {.videowrapper}
<iframe src="https://www.youtube.com/embed/uLSewGUPH1g"></iframe>
:::
::::
-->
<p>In this section, we will discuss an important result called <strong>Bayes’ theorem</strong>. Let’s first state and prove this result, and do an example, and then afterwards we’ll talk about two reasons why Bayes’ theorem is so important.</p>
<div id="thbayes" class="theorem" name="Bayes' theorem">
<p>For events <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> with <span class="math inline">\(\mathbb P(A), \mathbb P(B) &gt; 0\)</span>, we have [ P(A B) = . ]</p>
</div>
<p>Bayes’ theorem is thought to have first appeared in the writings of Rev.&nbsp;<a href="https://mathshistory.st-andrews.ac.uk/Biographies/Bayes/">Thomas Bayes</a>, a British church minister and mathematician, shortly after his death, in the 1760s. (Bayes’ work was significantly edited by <a href="https://mathshistory.st-andrews.ac.uk/Biographies/Price/">Richard Price</a>, another minister–mathematician, and many historians think that Price deserves a large share of the credit.)</p>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>From the definition of conditional probability, we can write <span class="math inline">\(\mathbb P(A \cap B)\)</span> in two different ways: we can write it as [ P(A B) = P(A) , P(BA) , ] but we can also write it as [ P(A B) = P(B) , P(AB) . ] Since these are two different ways of writing the same thing, we can equate them, to get [ P(A) , P(BA) = P(B) , P(AB) . ] Dividing both sides by <span class="math inline">\(\mathbb P(B)\)</span> gives the result.</p>
</div>
<div class="example">
<p><em>My friend again secretly picks the 4-sided, 6-sided, or 10-sided dice, each with probability <span class="math inline">\(\frac13\)</span>. He rolls that secret dice, and tells me he rolled a 5. What is the probability he picked the 6-sided dice?</em></p>
<p>This is asking us to calculate <span class="math inline">\(\mathbb P(D_6 \mid \text{roll 5})\)</span>. Bayes’ theorem tells us that [ P(D_6 ) = = = , ] since we had calculated <span class="math inline">\(\mathbb P(\text{roll 5}) = \frac{8}{90}\)</span> in the previous subsection.</p>
</div>
<p>The first way to think about Bayes’ theorem is that it tells us how to relate <span class="math inline">\(\mathbb P(A \mid B)\)</span> and <span class="math inline">\(\mathbb P(B \mid A)\)</span>. Remember that <span class="math inline">\(\mathbb P(A \mid B)\)</span> and <span class="math inline">\(\mathbb P(B \mid A)\)</span> are not the same thing! The conditional probability someone is under 40 given they are a Premiership footballer is very high, but the conditional probability someone is a Premiership footballer given they are under 40 is very low.</p>
<p>Bayes’ theorem, in this first view, is a useful technical result that helps us switch the order of a conditional probability from <span class="math inline">\(B\)</span> given <span class="math inline">\(A\)</span> to <span class="math inline">\(A\)</span> given <span class="math inline">\(B\)</span>: we have [ P(A B) = P(B A) . ]</p>
<p>In the dice example, the probability <span class="math inline">\(\mathbb P(\text{roll 5} \mid D_6) = \frac16\)</span> was very obvious, but Bayes’ theorem allowed us to reverse the conditioning, to find <span class="math inline">\(\mathbb P(D_6 \mid \text{roll 5}) = \frac58\)</span> instead.</p>
<p>The second way to think about Bayes’ theorem is that it tells us how to update our beliefs as we acquire more evidence. That is, we might start by believing that the probability some event <span class="math inline">\(A\)</span> will occur is <span class="math inline">\(\mathbb P(A)\)</span>. But then we find out that <span class="math inline">\(B\)</span> has occurred, so we want to incorporate this knowledge and update our belief of the probability <span class="math inline">\(A\)</span> will occur to <span class="math inline">\(\mathbb P(A \mid B)\)</span>, the conditional probability <span class="math inline">\(A\)</span> will occur given this new evidence <span class="math inline">\(B\)</span>.</p>
<p>Bayes theorem, in this second view, tells us how to update from <span class="math inline">\(\mathbb P(A)\)</span> to <span class="math inline">\(\mathbb P(A \mid B)\)</span>: we have [ P(A B) = P(A) . ]</p>
<p>In the dice example, we initially believed there was a <span class="math inline">\(\mathbb P(D_6) = \frac13 = 0.333\)</span> chance our friend had chosen the six-sided dice. But when we heard that our friend had rolled a 5, we updated our belief to now thinking there was now a <span class="math inline">\(\mathbb P(D_6 \mid \text{roll 5}) =\frac58 = 0.625\)</span> chance it was the 6-sided dice.</p>
<p>This second way of thinking about Bayes’ theorem is at the heart of <strong>Bayesian statistics</strong>. In Bayesian statistics, we start with a “prior” belief about a model, then, after collecting some data, we update, using Bayes’ theorem, to a “posterior” belief about the model. We will discuss Bayesian statistics much more in Week 10.</p>
<p>Quite often we use Bayes’ theorem and the law of total probability together. If we have a partition <span class="math inline">\(A_1, A_2, \dots, A_n\)</span>, perhaps representing some possible hypotheses, and we observe some evidence <span class="math inline">\(B\)</span>, then Bayes’ theorem tells us how likely each hypothesis is given the evidence: [ P(A_i B) = . ] But this shared denominator <span class="math inline">\(\mathbb P(B)\)</span> can be expanded using the law of total probability [ P(B) = _{j=1}^n P(A_j) ,P(B A_j) . ] Putting these together, we get the following.</p>
<div id="bayes-total" class="theorem">
<p>Let <span class="math inline">\(\{A_1, A_2, \dots, A_n\}\)</span> be a partition of a sample space and let <span class="math inline">\(B\)</span> be another event. Then, for all <span class="math inline">\(i=1,2,\dots,n\)</span>, we have [ P(A_i B) = . ]</p>
</div>
<p>This is essentially what we did with the dice example – although we split up the calculation into two separate parts rather than using this formula directly.</p>
</section>
<section id="screening" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="screening"><span class="header-section-number">8.3</span> Diagnostic testing</h2>
<div class="example">
<p><em>Members of the public are tested for a certain rare disease. About 2% of the population have the disease. The test is 95% accurate, in the following sense: if you have the disease, there’s a 95% chance you correctly get a positive test result; while if you don’t have the disease, there’s a 95% chance you correctly get a negative test result. Suppose you get a positive test result. What is the probability you have the disease?</em></p>
<p>The first thing we have to do is translate the words in the question into probability statements. Let <span class="math inline">\(D\)</span> be the event you have the disease, so <span class="math inline">\(D^\comp\)</span> is the event you don’t have the disease, and let <span class="math inline">\(+\)</span> be the event you get a positive result. Then the question tells us that</p>
<ul>
<li><span class="math inline">\(\mathbb P(D) = 0.02\)</span> and <span class="math inline">\(\mathbb P(D^\comp) = 0.98\)</span>;</li>
<li><span class="math inline">\(\mathbb P({+} \mid D) = 0.95\)</span>;</li>
<li><span class="math inline">\(\mathbb P({+}\mid D^\comp) = 0.05\)</span>;</li>
<li>we want to find <span class="math inline">\(\mathbb P(D \mid {+})\)</span>.</li>
</ul>
<p>Importantly, <span class="math inline">\(D\)</span> (you have the disease) and <span class="math inline">\(D^\comp\)</span> (you don’t) make up a partition. So Theorem @ref(thm:bayes-total) tells us that [ P(D ) = . ] Putting in all the numbers we have, we get [ P(D ) = = 0.28 .]</p>
<p>So if you get a positive result on this 95%-accurate test, there’s still only about a 1 in 4 chance you actually have the disease.</p>
</div>
<p>Many people find this result surprising. It sometimes helps to put more concrete numbers on things. Suppose 1000 people get tested. On average, we expect about 20 of them to have the disease, and 980 of to not have the disease. Of the 20 with the disease, on average 19 will correctly test positive, while 1 will test negative. Of the 980 without the disease, an average 931 will correctly test negative, but 49 will wrongly test positive. So of the <span class="math inline">\(19+49 = 68\)</span> people with positive tests, only 19 of them actually have the disease, which is 28%.</p>
<p>The key point is that the disease is rare – only 2% of people have it. So even though positive test increases the likelihood you have the disease a lot (it’s about 14 times more likely), it’s not enough to make it a very large probability.</p>
</section>
<section id="summary-L08" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="summary-L08">Summary</h2>
<div class="mysummary">
<ul>
<li>The law of total probability says that if <span class="math inline">\(A_1, A_2, \dots A_n\)</span> is a partition of the sample space (that is, exactly one of them occurs), then [ P(B) = _{i=1}^n P(A_i) , P(B A_i) . ]</li>
<li>Bayes’ theorem says that <span class="math inline">\({\displaystyle \mathbb P(A \mid B) = \frac{\mathbb P(A) \,\mathbb P(B \mid A)}{\mathbb P(B)} }\)</span>.</li>
</ul>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../sections/L07-conditional.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Independence and conditional probability</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../sections/L09-discrete-rv.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Discrete random variables</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>