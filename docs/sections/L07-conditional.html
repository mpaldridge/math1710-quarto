<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>MATH1710 Probability and Statistics 1 - 7&nbsp; Independence and conditional probability</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../sections/L08-two-theorems.html" rel="next">
<link href="../sections/L06-classical-ii.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Independence and conditional probability</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">MATH1710 Probability and Statistics 1</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../about.html" class="sidebar-item-text sidebar-link">About MATH1710</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Exploratory data analysis</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L01-stats.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Summary statistics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L02-dataviz.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data visualisations</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Probability</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L03-events.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Sample spaces and events</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L04-probability.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L05-classical-i.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Classical probability I</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L06-classical-ii.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Classical probability II</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L07-conditional.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Independence and conditional probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L08-two-theorems.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Two theorems on conditional probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L09-discrete-rv.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Discrete random variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L10-expectation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Expectation and variance</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L11-binomial-geometric.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Binomial and geometric distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L12-poisson.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Poisson distribution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L13-multi-rv.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Multiple random variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L14-covariance.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Expectation and covariance</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L15-continuous.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Continuous random variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L17-normal.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Normal distribution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L16-exponential-multi.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Exponential distribution and multiple continuous random variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L18-limit.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Limit theorems</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Bayesian statistics</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L19-bayes-idea.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">The Bayesian idea</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L20-bayes-models.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">More Bayesian models</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Other stuff</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L21-summary.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">All questions answered</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/L22-exam.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Exam</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../R/R.html" class="sidebar-item-text sidebar-link">R Worksheets</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../writing.html" class="sidebar-item-text sidebar-link">Tips on writing mathematics</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">MATH1710</h2>
   
  <ul>
  <li><a href="#independent-events" id="toc-independent-events" class="nav-link active" data-scroll-target="#independent-events"><span class="toc-section-number">7.1</span>  Independent events</a></li>
  <li><a href="#conditional" id="toc-conditional" class="nav-link" data-scroll-target="#conditional"><span class="toc-section-number">7.2</span>  Conditional probability</a></li>
  <li><a href="#chain-rule" id="toc-chain-rule" class="nav-link" data-scroll-target="#chain-rule"><span class="toc-section-number">7.3</span>  Chain rule</a></li>
  <li><a href="#summary-L07" id="toc-summary-L07" class="nav-link" data-scroll-target="#summary-L07">Summary</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="L07-conditional" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Independence and conditional probability</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="independent-events" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="independent-events"><span class="header-section-number">7.1</span> Independent events</h2>
<!--
:::: {.videowrap}
::: {.videowrapper}
<iframe src="https://www.youtube.com/embed/9lhF4WEoJxk"></iframe>
:::
::::
-->
<p><em>Suppose 40% of people have blond hair, and 20% of people have blue eyes. What proportion of people have both blond hair and blue eyes?</em></p>
<p>The answer to this question is: we don’t know. The question doesn’t give us enough information to tell. However, <em>if</em> it were the case that having blond hair didn’t effect your chance of having blue eyes, <em>then</em> we could work out the answer. If that were true, we would think that the 20% of people with blue eyes would equally make up both 20% of the blonds and also 20% of the non-blonds. Thus the proportion of people with blond hair and blue eyes would be this 20% of the 40% of people with blond hair; and 20% of 40% is <span class="math inline">\(0.2 \times 0.4 = 0.08\)</span>, or 8%.</p>
<p>To put it in probability language, <em>if</em> blond hair and blue eyes were unrelated, then we would expect that [ P() = P() P() . ] This is an important property known as “independence”.</p>
<div class="definition">
<p>Two events <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are said to be <strong>independent</strong> if [ P(A B) = P(A), P(B) . ]</p>
</div>
<p>There are two ways we can use this definition.</p>
<ul>
<li>If we know <span class="math inline">\(\mathbb P(A)\)</span>, <span class="math inline">\(\mathbb P(B)\)</span>, and <span class="math inline">\(\mathbb P(A \cap B)\)</span>, then we can find out whether or not <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are independent by checking whether or not <span class="math inline">\(\mathbb P(A \cap B) = \mathbb P(A)\, \mathbb P(B)\)</span>.</li>
<li>If we know <span class="math inline">\(\mathbb P(A)\)</span> and <span class="math inline">\(\mathbb P(B)\)</span> and we know that <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are independent, then we can find <span class="math inline">\(\mathbb P(A \cap B)\)</span> by calculating <span class="math inline">\(\mathbb P(A \cap B) = \mathbb P(A)\, \mathbb P(B)\)</span>.</li>
</ul>
<p>In this second case, we might know <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are independent because we are specifically told they are in a question. But alternatively we might reason that <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> must be independent because the related experiments are not physically related. For example if we roll a dice then toss a coin, we might reason that <span class="math inline">\(\{\text{roll a 5}\}\)</span> and <span class="math inline">\(\{\text{the coin lands Heads}\}\)</span> must be independent because the dice roll doesn’t effect the coin toss – we could then use the independence assumption in calculations.</p>
<div class="example">
<p><em>Consider rolling a dice. Let <span class="math inline">\(A = \{\text{even number}\} = \{2,4,6\}\)</span>, and let <span class="math inline">\(B = \{\text{roll at least 4}\} = \{4,5,6\}\)</span>. Are <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> independent?</em></p>
<p>Clearly we have <span class="math inline">\(\mathbb P(A) = \frac36 = \frac12\)</span> and <span class="math inline">\(\mathbb P(B) = \frac 36 = \frac12\)</span>. The intersection is <span class="math inline">\(A \cap B = \{4,6\}\)</span>, so <span class="math inline">\(\mathbb P(A \cap B) = \frac26 = \frac13\)</span>. So we see that [ P(AB) = P(A), P(B) = = . ] So <span class="math inline">\(\mathbb P(A \cap B) \neq \mathbb P(A)\, \mathbb P(B)\)</span>, and the two events are not independent.</p>
</div>
<div class="example">
<p><em>A biased coin has probability <span class="math inline">\(p\)</span> of landing Heads and probability <span class="math inline">\(1-p\)</span> of landing Tails. You toss the coin 3 times. Assuming tosses of the coin are independent, calculate the probability of getting exactly 2 Heads.</em></p>
<p>There are three ways we could get exactly 2 Heads: HHT, HTH, or THH. For the first of these, [ P() = P( ) . ] Since tosses of the coin are independent, we therefore have <span class="math display">\[\begin{align*}
\mathbb P(\text{HHT})
  &amp;= \mathbb P(\text{first coin H}) \times \mathbb P ( \text{second coin H} )\times \mathbb P(\text{third coin T}) \\
  &amp;=p \times p \times (1-p) \\
  &amp;= p^2(1-p).
\end{align*}\]</span></p>
<p>Similarly, [ P() = P() = p^2(1-p) ] also.</p>
<p>Finally, because the events are disjoint, we have [ P( ) = P( ) + P() + P() = 3p^2(1-p) . ]</p>
</div>
</section>
<section id="conditional" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="conditional"><span class="header-section-number">7.2</span> Conditional probability</h2>
<!--
:::: {.videowrap}
::: {.videowrapper}
<iframe src="https://www.youtube.com/embed/x3wISv0RWic"></iframe>
:::
::::
-->
<p>Let us to return to the example of blond hair and blue eyes. Suppose the population statistics are like this:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><strong>Brown hair</strong></th>
<th style="text-align: center;"><strong>Blond hair</strong></th>
<th style="text-align: center;"><strong>Total</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>Brown eyes</strong></td>
<td style="text-align: center;">50%</td>
<td style="text-align: center;">30%</td>
<td style="text-align: center;"><strong>80%</strong></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Blue eyes</strong></td>
<td style="text-align: center;">10%</td>
<td style="text-align: center;">10%</td>
<td style="text-align: center;"><strong>20%</strong></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Total</strong></td>
<td style="text-align: center;"><strong>60%</strong></td>
<td style="text-align: center;"><strong>40%</strong></td>
<td style="text-align: center;"><strong>100%</strong></td>
</tr>
</tbody>
</table>
<p>It turns out that <span class="math inline">\(\mathbb P(\text{blond hair and blue eyes}) = 0.1 \neq 0.08\)</span>, so having blond hair and having blue eyes are not in fact independent.</p>
<p>We know from this table that 20% of people have blue eyes. But suppose you already know that someone has blond hair: what <em>then</em> is the probability they have blue eyes <em>given</em> that they have blond hair?</p>
<p>Well, the 40% of blond-haired people is made up of the 10% of people who also have blue eyes along with their blond hair, and the 30% of people who have brown eyes along with their blond hair. So of the 40% of blond-haired people, only one quarter of that 40% – which makes 10% – have blue eyes. If we use a vertical line <span class="math inline">\(|\)</span> in a probability to mean “given” (or “assuming that” or “conditional upon”), then we can write this as [ P( ) = = = . ]</p>
<p>What we’ve seen here is called a “conditional probability”.</p>
<div class="definition">
<p>Let <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> be events, with <span class="math inline">\(\mathbb P(A) &gt; 0\)</span>. Then the <strong>conditional probability of <span class="math inline">\(B\)</span> given <span class="math inline">\(A\)</span></strong> is defined to be [ P(B A) = . ]</p>
</div>
<p>The condition <span class="math inline">\(\mathbb P(A) &gt; 0\)</span> is just to ensure we don’t have any “divide by 0” errors. (I normally won’t bother saying this explicitly – any statement about conditional probability will implicitly assume that the event being conditioned on has nonzero probability.)</p>
<p>Conditional probability ties in with independence in an important way. Suppose <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are independent, so <span class="math inline">\(\mathbb P(A \cap B) = \mathbb P(A) \, \mathbb P(B)\)</span>. Then the conditional probability becomes [ P(B A) = P(B A) = = = P(B) , ] so <span class="math inline">\(\mathbb P(B \mid A) = \mathbb P(B)\)</span>. In other words, if <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are independent, then <span class="math inline">\(A\)</span> happening doesn’t affect the probability of <span class="math inline">\(B\)</span> happening (and vice versa).</p>
<p>So when we have independence, <span class="math inline">\(\mathbb P(A \cap B) = \mathbb P(A)\,\mathbb P(B)\)</span>, and the mathematics is quite easy. But conditional probability tells us how things work when we don’t have independence.</p>
<p>Like with independence, we can use the definition of conditional probability in two ways. The first way is that if we know <span class="math inline">\(\mathbb P(A \cap B)\)</span> and <span class="math inline">\(\mathbb P(A)\)</span>, then we can calculate the conditional probability of <span class="math inline">\(B\)</span> given <span class="math inline">\(A\)</span> as [ P(B A) = . ]</p>
<div class="example">
<p><em>With the dice roll again, what’s the probability of rolling at least 4 given that you roll an even number?</em></p>
<p>We previously calculated <span class="math display">\[\begin{gather*}
\mathbb P(\text{even and at least 4}) = \mathbb P(A \cap B) = \tfrac{1}{3} \\
\mathbb P(\text{even number}) = \mathbb P(A) = \tfrac{1}{2} .
\end{gather*}\]</span> Hence [ P( ) = P(B A) = = = . ]</p>
<p>This is intuitively correct: of the three possibilities of rolling at least 4, <span class="math inline">\(\{4,5,6\}\)</span>, two of those three are even, so the probability is <span class="math inline">\(\frac23\)</span>.</p>
</div>
</section>
<section id="chain-rule" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="chain-rule"><span class="header-section-number">7.3</span> Chain rule</h2>
<p>The second way to use the definition of conditional probability is that if we know <span class="math inline">\(\mathbb P(A)\)</span> and <span class="math inline">\(\mathbb P(B \mid A)\)</span>, then we can calculate the event that both <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> occur as [ P(A B) = P(A), P(B A). ] This can be a particularly useful tool when <span class="math inline">\(A\)</span> concerns the first stage of an experiment and <span class="math inline">\(B\)</span> the second stage. This says that the probability <span class="math inline">\(A\)</span> happens then <span class="math inline">\(B\)</span> happens is equal to the probability <span class="math inline">\(A\)</span> happens multiplied the conditional probability, given that <span class="math inline">\(A\)</span> has already happened, that <span class="math inline">\(B\)</span> then happens too.</p>
<p>We can extend this to more events. For three events, we have <span class="math display">\[\begin{align*}
\mathbb P(A \cap B \cap C)
  &amp;= \mathbb P(A \cap B) \, \mathbb P(C \mid A \cap B) \\
  &amp;= \mathbb P(A) \, \mathbb P(B \mid A)\, \mathbb P(C \mid A \cap B) ,
\end{align*}\]</span> which can be useful when we have three stages of an experiment.</p>
<p>Continuing that process, we get a general rule.</p>
<div id="thchain" class="theorem" name="Chain rule">
<p>For events <span class="math inline">\(A_1, A_2, \dots, A_n\)</span>, we have <span class="math display">\[\begin{multline*}  \mathbb P(A_1 \cap A_2 \cap \cdots \cap A_n) \\
  = \mathbb P(A_1) \, \mathbb P(A_2 \mid A_1) \, \mathbb P(A_3 \mid A_1 \cap A_2) \cdots \mathbb P(A_n \mid A_1 \cap A_2 \cap \cdots \cap  A_{n-1}) .\end{multline*}\]</span></p>
</div>
<p>At each step, we need to calculate the probability of that step given all the previous steps being successful. We then multiply them all together.</p>
<p>Often questions that can be solved using the classical probability counting methods from Section 3 also be solved “step by step” using the chain rule. (It’s a matter of personal taste which you prefer, but I find that chain rule methods are often simpler and more intuitive.)</p>
<div class="example">
<p><em>Recall the Lotto problem from Example @ref(exm:lotto): What is the probability we match 6 balls from 59?</em></p>
<p>Let <span class="math inline">\(A_1, A_2, \dots, A_6\)</span> be the events that the first, second, …, sixth balls out of the machine are on our ticket. Clearly <span class="math inline">\(\mathbb P(A_1) = \frac{6}{59}\)</span>, as we have six numbers on our ticket that the first ball could match. The conditional probability that the second ball matches given that the first ball matched is <span class="math inline">\(\mathbb P(A_2 \mid A_1) = \frac{5}{58}\)</span>, because there are 58 balls left in the machine and, given that we got the first number right, there are 5 numbers left on our ticket. Similarly, <span class="math inline">\(\mathbb P(A_3 \mid A_1 \cap A_2) = \frac{4}{57}\)</span>, and so on, until <span class="math inline">\(\mathbb P(A_6 \mid A_1 \cap \cdots\cap A_5) = \frac{1}{54}\)</span>.</p>
<p>So, using the chain rule, we get <span class="math display">\[\begin{align*}
\mathbb P(A_1 \cap A_2 &amp;\cap \cdots \cap A_6) \\
&amp;= \mathbb P(A_1) \, \mathbb P(A_2 \mid A_1) \, \mathbb P(A_3 \mid A_1 \cap A_2) \cdots \mathbb P(A_6 \mid A_1 \cap \cdots \cap A_5) \\
&amp;= \frac{6}{59} \times \frac{5}{58} \times \frac{4}{57} \times \frac{3}{56} \times \frac{2}{55} \times \frac{1}{54} .
\end{align*}\]</span></p>
<p>The answer we got before was [ = = . ] It’s easy to see that this is the same answer. The structure of the answers shows how our previous classical probability method got the answer “all at once”, while this new chain rule method gets the answer “one step at a time”.</p>
</div>
</section>
<section id="summary-L07" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="summary-L07">Summary</h2>
<div class="mysummary">
<ul>
<li>Two events are independent if <span class="math inline">\(\mathbb P(A \cap B) = \mathbb P(A)\, \mathbb P(B)\)</span>.</li>
<li>The conditional probability of <span class="math inline">\(B\)</span> given <span class="math inline">\(A\)</span> is <span class="math inline">\({\displaystyle \mathbb P(B \mid A) = \frac{\mathbb P(A \cap B)}{\mathbb P(A)}}\)</span>.</li>
<li>The chain rule is <span class="math display">\[\begin{multline*}
\mathbb P(A_1 \cap A_2 \cap \cdots \cap A_n) \\
= \mathbb P(A_1) \, \mathbb P(A_2 \mid A_1) \, \mathbb P(A_3 \mid A_1 \cap A_2) \cdots \mathbb P(A_n \mid A_1 \cap \cdots \cap  A_{n-1}) .
\end{multline*}\]</span></li>
</ul>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../sections/L06-classical-ii.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Classical probability II</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../sections/L08-two-theorems.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Two theorems on conditional probability</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>